<!DOCTYPE html>
<html>
<head>
    <title>TaskBoard - {{ title }}</title>
</head>
<body>
    <h1>ðŸ“‹ {{ title }}</h1>
    <p>Board ID: {{ board_id }}</p>

    <a href="/dashboard">ðŸ”™ Back to Dashboard</a>

    <hr>

    <h2> Add a Task</h2>
    <form method="post" action="/board/{{ board_id }}/add_task">
        <input type="text" name="task_title" placeholder="Task title" required>
        <input type="date" name="due_date" required>
        <button type="submit">Add Task</button>
    </form>

    <hr>

    <h2>ðŸ™‹ Invite a User</h2>
    <form method="post" action="/board/{{ board_id }}/invite">
        <input type="email" name="user_email" placeholder="Enter email address" required>
        <button type="submit">Invite</button>
    </form>

    <hr>

    <h2>ðŸ—‹ Tasks</h2>
    <ul id="task-list">
        
    </ul>

    <script>
        async function loadTasks() {
            const res = await fetch("/board/{{ board_id }}/tasks");
            const data = await res.json();
            const list = document.getElementById("task-list");
            list.innerHTML = "";

            if (data.tasks && data.tasks.length > 0) {
                data.tasks.forEach(task => {
                    const li = document.createElement("li");
                    li.innerHTML = `
                        <form method="post" action="/board/{{ board_id }}/update_task/${task.id}" style="display:inline">
                            <input type="checkbox" name="complete" value="true" onchange="this.form.submit()" ${task.complete ? 'checked' : ''}>
                            ${task.title} (Due: ${task.due_date})
                        </form>
                    `;
                    list.appendChild(li);
                });
            } else {
                list.innerHTML = "<li>No tasks found.</li>";
            }
        }

        window.onload = loadTasks;
    </script>
</body>
</html>
